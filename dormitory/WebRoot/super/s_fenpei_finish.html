<style type="text/css">
a.xz_fenpeijg {
	display:none;
}
.datagrid-wrap {
	margin-bottom:30px;
}
</style>
<div class="table_one"></div>
<input type="button" class="xz_fenpeijg" name="xiazai" value="下载分配结果" /> 
<script type="text/javascript">
	var grade="";
	var education = "";
	var sex = "";
	var academy = "";
	var major = "";
	var classNum = "";
	if(sum_dhstu_kong>0){
			grade=diaohuan_sure.grade;
			education=diaohuan_sure.education;
			sex=diaohuan_sure.sex;
			academy=diaohuan_sure.academy;
			major=diaohuan_sure.major;
			classNum=diaohuan_sure.classNum;
			sum_diaohuan=0;
			sum_dhstu_kong=0;
			diaohuan_sure={"academy" : "","education":"","grade":"","major" : "","classNum" : "","sex" : ""};//存放选择新生分配的条件  
	} else if(sum_newstu_kong>0){
			grade=fenpei_sure.grade;
			education=fenpei_sure.education;
			sex=fenpei_sure.sex;
			academy=fenpei_sure.academy;
			major=fenpei_sure.major;
			classNum=fenpei_sure.classNum;
			sum_fenpei=0;
			sum_newstu_kong=0;
			fenpei_sure={"academy" : "","education":"","grade":"","major" : "","classNum" : "","sex" : ""};//存放选择新生分配的条件  
	}
	$.post('studentInfo/findStudentByCondition.do', {"academy":academy,"education":education,"grade":grade,"major":major,"classNum":classNum,"sex":sex}, function(data) {
		$(".table_one").datagrid({
			data : data,
			width : '865px',
			height : '330px',
			nowrap : false,
			columns : [ [
			         {field : 'room',title : '寝室号',width : 80,align : 'center',
						 formatter:function(value){
						 	if(value==null){
						 		return "未入住";
						 	}else{
						 		return value.roomNum;
						 	}
					 	}
					 }, 
					{field : 'academy',title : '学院',width : 130,align : 'center',
						 formatter:function(value){
							 return value.name;
						 }
					 }, 
					{field : 'major',title : '专业',width : 200,align : 'center'},
					{field : 'classNum',title : '班级',width : 100,align : 'center'}, 
					{field : 'stuNum',title : '学号',width : 100,align : 'center'},
					{field : 'name',title : '姓名',width : 100,align : 'center'}, 
					{field : 'sex',title : '性别',width : 60,align : 'center'} 
			] ],
			pagination : true
		});
		$(".xz_fenpeijg").show();
	});
	var pager = $('.table_one').datagrid().datagrid('getPager');// get the pager of datagrid
	pager.pagination({
		beforePageText : "第",
		afterPageText : "共{pages}页",
		displayMsg : "显示{from}到{to},共{total}条记录"
	});
	//点击下载分配结果
	$(".xz_fenpeijg").click(function(){
		$.messager.confirm('确认', '确认下载?', function(row) {
			if (row) {
				$.get('roomInfo/downLoadExcel.do', {"academy":academy,"education":education,"grade":grade,"major":major,"classNum":classNum,"sex":sex});
		}
	});
	});
</script>